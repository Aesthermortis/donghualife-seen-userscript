{
  "branches": ["master"],
  "plugins": [
    ["@semantic-release/commit-analyzer", { "preset": "conventionalcommits" }],
    ["@semantic-release/release-notes-generator", { "preset": "conventionalcommits" }],
    ["@semantic-release/changelog", { "changelogFile": "CHANGELOG.md" }],
    [
      "@semantic-release/exec",
      {
        "prepareCmd": "USERSCRIPT_VERSION=${nextRelease.version} npm run build && node -e \"const fs=require('fs');const v='${nextRelease.version}';const s=fs.readFileSync('dist/donghualife-seen.user.js','utf8');if(!/^\\/\\/\\s*@version\\s+${nextRelease.version}/m.test(s)){throw new Error('Version mismatch in dist: expected '+v);}\""
      }
    ],
    [
      "@semantic-release/github",
      {
        "assets": [
          { "path": "dist/donghualife-seen.user.js", "label": "Dongualife Seen userscript" }
        ]
      }
    ],
    [
      "@semantic-release/git",
      {
        "assets": ["CHANGELOG.md"],
        "message": "chore(release): ${nextRelease.version} [skip ci]\n\n${nextRelease.notes}"
      }
    ]
  ]
}
